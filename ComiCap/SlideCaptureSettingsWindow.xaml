<Window x:Class="ComiCap.SlideCaptureSettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="スライド自動キャプチャ設定"
        Width="600"
        Height="750"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        ShowInTaskbar="True">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- スクロール可能な設定エリア -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="0,10,0,10">
            <StackPanel>
                <!-- URL -->
                <TextBlock Text="ブラウザURL（省略可）:" FontWeight="Bold" Margin="0,0,0,5"/>
                <TextBox x:Name="UrlTextBox"
                         Height="25"
                         Margin="0,0,0,15"
                         ToolTip="キャプチャ対象のURL（省略時は既存のアクティブウィンドウを使用）"/>

                <!-- ページめくりキー -->
                <TextBlock Text="ページめくりキー:" FontWeight="Bold" Margin="0,0,0,5"/>
                <ComboBox x:Name="PageTurnKeyComboBox"
                          Height="25"
                          Margin="0,0,0,15"
                          ToolTip="ページ送りに使用するキー">
                    <ComboBoxItem Content="→ (Right)" Tag="Right" IsSelected="True"/>
                    <ComboBoxItem Content="← (Left)" Tag="Left"/>
                    <ComboBoxItem Content="↓ (Down)" Tag="Down"/>
                    <ComboBoxItem Content="↑ (Up)" Tag="Up"/>
                    <ComboBoxItem Content="スペース (Space)" Tag="Space"/>
                    <ComboBoxItem Content="PageDown" Tag="PageDown"/>
                    <ComboBoxItem Content="PageUp" Tag="PageUp"/>
                    <ComboBoxItem Content="Enter" Tag="Enter"/>
                </ComboBox>

                <!-- キャプチャ間隔 -->
                <TextBlock Text="キャプチャ間隔（ミリ秒）:" FontWeight="Bold" Margin="0,0,0,5"/>
                <Grid Margin="0,0,0,5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="80"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="CaptureIntervalSlider"
                            Grid.Column="0"
                            Minimum="100"
                            Maximum="10000"
                            Value="1000"
                            TickFrequency="100"
                            IsSnapToTickEnabled="True"
                            VerticalAlignment="Center"
                            ValueChanged="CaptureIntervalSlider_ValueChanged"/>
                    <TextBox x:Name="CaptureIntervalTextBox"
                             Grid.Column="1"
                             Text="1000"
                             Height="25"
                             Margin="10,0,0,0"
                             VerticalContentAlignment="Center"
                             TextChanged="CaptureIntervalTextBox_TextChanged"/>
                </Grid>
                <TextBlock x:Name="CaptureIntervalLabel"
                           Text="待機時間: 1.0秒"
                           FontSize="11"
                           Foreground="Gray"
                           Margin="0,0,0,15"/>

                <!-- キャプチャ回数 -->
                <TextBlock Text="キャプチャ回数（0で無限）:" FontWeight="Bold" Margin="0,0,0,5"/>
                <TextBox x:Name="CaptureCountTextBox"
                         Text="10"
                         Height="25"
                         Margin="0,0,0,5"
                         ToolTip="キャプチャする回数（0を指定すると手動停止まで継続）"/>
                <TextBlock Text="※0を指定すると手動停止まで継続"
                           FontSize="11"
                           Foreground="Gray"
                           Margin="0,0,0,15"/>

                <!-- 保存先フォルダ -->
                <TextBlock Text="保存先フォルダ:" FontWeight="Bold" Margin="0,0,0,5"/>
                <Grid Margin="0,0,0,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="SaveDirectoryTextBox"
                             Grid.Column="0"
                             Height="25"
                             IsReadOnly="True"
                             VerticalContentAlignment="Center"/>
                    <Button Grid.Column="1"
                            Content="参照..."
                            Width="70"
                            Height="25"
                            Margin="10,0,0,0"
                            Click="BrowseSaveDirectory_Click"/>
                </Grid>

                <!-- 画像形式 -->
                <TextBlock Text="画像形式:" FontWeight="Bold" Margin="0,0,0,5"/>
                <ComboBox x:Name="ImageFormatComboBox"
                          Height="25"
                          Margin="0,0,0,15"
                          SelectionChanged="ImageFormatComboBox_SelectionChanged">
                    <ComboBoxItem Content="PNG" Tag="PNG" IsSelected="True"/>
                    <ComboBoxItem Content="JPEG" Tag="JPEG"/>
                    <ComboBoxItem Content="BMP" Tag="BMP"/>
                </ComboBox>

                <!-- JPEG品質 -->
                <TextBlock x:Name="JpegQualityLabel" Text="JPEG品質:" FontWeight="Bold" Margin="0,0,0,5"/>
                <Grid x:Name="JpegQualityPanel" Margin="0,0,0,15" Visibility="Collapsed">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <Slider x:Name="JpegQualitySlider"
                            Grid.Column="0"
                            Minimum="0"
                            Maximum="100"
                            Value="90"
                            TickFrequency="5"
                            IsSnapToTickEnabled="True"
                            VerticalAlignment="Center"
                            ValueChanged="JpegQualitySlider_ValueChanged"/>
                    <TextBlock x:Name="JpegQualityValueLabel"
                               Grid.Column="1"
                               Text="90"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"
                               FontSize="14"
                               FontWeight="Bold"/>
                </Grid>

                <!-- ファイル名プレフィックス -->
                <TextBlock Text="ファイル名プレフィックス:" FontWeight="Bold" Margin="0,0,0,5"/>
                <TextBox x:Name="FileNamePrefixTextBox"
                         Text="slide"
                         Height="25"
                         Margin="0,0,0,5"
                         ToolTip="ファイル名の先頭に付ける文字列"/>
                <TextBlock Text="例: slide_001.png, slide_002.png, ..."
                           FontSize="11"
                           Foreground="Gray"
                           Margin="0,0,0,15"/>

                <!-- ブラウザパス -->
                <TextBlock Text="ブラウザパス（省略可）:" FontWeight="Bold" Margin="0,0,0,5"/>
                <Grid Margin="0,0,0,5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="BrowserPathTextBox"
                             Grid.Column="0"
                             Height="25"
                             VerticalContentAlignment="Center"
                             ToolTip="使用するブラウザの実行ファイルパス"/>
                    <Button Grid.Column="1"
                            Content="参照..."
                            Width="70"
                            Height="25"
                            Margin="10,0,0,0"
                            Click="BrowseBrowserPath_Click"/>
                </Grid>
                <TextBlock Text="※省略時はシステムデフォルトブラウザを使用"
                           FontSize="11"
                           Foreground="Gray"
                           Margin="0,0,0,15"/>

                <!-- ブラウザを最大化 -->
                <CheckBox x:Name="MaximizeBrowserCheckBox"
                          Content="ブラウザウィンドウを最大化"
                          IsChecked="True"
                          Margin="0,0,0,15"/>
            </StackPanel>
        </ScrollViewer>

        <!-- ボタンエリア -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button x:Name="StartButton"
                    Content="開始"
                    Width="100"
                    Height="30"
                    Margin="0,0,10,0"
                    Click="StartButton_Click"
                    IsDefault="True"/>
            <Button x:Name="CancelButton"
                    Content="キャンセル"
                    Width="100"
                    Height="30"
                    Click="CancelButton_Click"
                    IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>
